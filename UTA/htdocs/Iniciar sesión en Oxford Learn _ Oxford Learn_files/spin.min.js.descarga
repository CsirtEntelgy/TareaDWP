!function(a,b){"object"==typeof exports?module.exports=b():"function"==typeof define&&define.amd?define(b):a.Spinner=b()}(this,function(){function b(r,s){var p,q=document.createElement(r||"div");for(p in s){q[p]=s[p]}return q}function d(q){for(var r=1,p=arguments.length;p>r;r++){q.appendChild(arguments[r])}return q}function f(v,w,x,p){var q=["opacity",w,~~(100*v),x,p].join("-"),r=0.01+x/p*100,s=Math.max(1-(1-v)/w*(100-r),v),t=m.substring(0,m.indexOf("Animation")).toLowerCase(),u=t&&"-"+t+"-"||"";return o[q]||(a.insertRule("@"+u+"keyframes "+q+"{0%{opacity:"+s+"}"+r+"%{opacity:"+v+"}"+(r+0.01)+"%{opacity:1}"+(r+w)%100+"%{opacity:"+v+"}100%{opacity:"+s+"}}",a.cssRules.length),o[q]=1),q}function g(s,t){var p,q,r=s.style;for(t=t.charAt(0).toUpperCase()+t.slice(1),q=0;q<n.length;q++){if(p=n[q]+t,void 0!==r[p]){return p}}return void 0!==r[t]?t:void 0}function h(q,r){for(var p in r){q.style[g(q,p)||p]=r[p]}return q}function i(r){for(var s=1;s<arguments.length;s++){var p=arguments[s];for(var q in p){void 0===r[q]&&(r[q]=p[q])}}return r}function j(p,q){return"string"==typeof p?p:p[q%p.length]}function k(p){this.opts=i(p||{},k.defaults,c)}function l(){function p(r,q){return b("<"+r+' xmlns="urn:schemas-microsoft.com:vml" class="spin-vml">',q)}a.addRule(".spin-vml","behavior:url(#default#VML)"),k.prototype.lines=function(w,x){function y(){return h(p("group",{coordsize:t+" "+t,coordorigin:-s+" "+-s}),{width:t,height:t})}function q(B,z,A){d(v,d(h(y(),{rotation:360/x.lines*B+"deg",left:~~z}),d(h(p("roundrect",{arcsize:x.corners}),{width:s,height:x.width,left:x.radius,top:-x.width>>1,filter:A}),p("fill",{color:j(x.color,B),opacity:x.opacity}),p("stroke",{opacity:0}))))}var r,s=x.length+x.width,t=2*s,u=2*-(x.width+x.length)+"px",v=h(y(),{position:"absolute",top:u,left:u});if(x.shadow){for(r=1;r<=x.lines;r++){q(r,-2,"progid:DXImageTransform.Microsoft.Blur(pixelradius=2,makeshadow=1,shadowopacity=.3)")}}for(r=1;r<=x.lines;r++){q(r)}return d(w,v)},k.prototype.opacity=function(t,u,q,r){var s=t.firstChild;r=r.shadow&&r.lines||0,s&&u+r<s.childNodes.length&&(s=s.childNodes[u+r],s=s&&s.firstChild,s=s&&s.firstChild,s&&(s.opacity=q))}}var m,n=["webkit","Moz","ms","O"],o={},a=function(){var p=b("style",{type:"text/css"});return d(document.getElementsByTagName("head")[0],p),p.sheet||p.styleSheet}(),c={lines:12,length:7,width:5,radius:10,rotate:0,corners:1,color:"#000",direction:1,speed:1,trail:100,opacity:0.25,fps:20,zIndex:2000000000,className:"spinner",top:"50%",left:"50%",position:"absolute"};k.defaults={},i(k.prototype,{spin:function(r){this.stop();var s=this,t=s.opts,v=s.el=h(b(0,{className:t.className}),{position:t.position,width:0,zIndex:t.zIndex});t.radius+t.length+t.width;if(h(v,{left:t.left,top:t.top}),r&&r.insertBefore(v,r.firstChild||null),v.setAttribute("role","progressbar"),s.lines(v,s.opts),!m){var w,x=0,y=(t.lines-1)*(1-t.direction)/2,z=t.fps,A=z/t.speed,p=(1-t.opacity)/(A*t.trail/100),q=A/t.lines;!function u(){x++;for(var B=0;B<t.lines;B++){w=Math.max(1-(x+(t.lines-B)*q)%A*p,t.opacity),s.opacity(v,B*t.direction+y,w,t)}s.timeout=s.el&&setTimeout(u,~~(1000/z))}()}return s},stop:function(){var p=this.el;return p&&(clearTimeout(this.timeout),p.parentNode&&p.parentNode.removeChild(p),this.el=void 0),this},lines:function(r,s){function t(w,v){return h(b(),{position:"absolute",width:s.length+s.width+"px",height:s.width+"px",background:w,boxShadow:v,transformOrigin:"left",transform:"rotate("+~~(360/s.lines*p+s.rotate)+"deg) translate("+s.radius+"px,0)",borderRadius:(s.corners*s.width>>1)+"px"})}for(var u,p=0,q=(s.lines-1)*(1-s.direction)/2;p<s.lines;p++){u=h(b(),{position:"absolute",top:1+~(s.width/2)+"px",transform:s.hwaccel?"translate3d(0,0,0)":"",opacity:s.opacity,animation:m&&f(s.opacity,s.trail,q+p*s.direction,s.lines)+" "+1/s.speed+"s linear infinite"}),s.shadow&&d(u,h(t("#000","0 0 4px #000"),{top:"2px"})),d(r,d(u,t(j(s.color,p),"0 0 1px rgba(0,0,0,.1)")))}return r},opacity:function(q,r,p){r<q.childNodes.length&&(q.childNodes[r].style.opacity=p)}});var e=h(b("group"),{behavior:"url(#default#VML)"});return !g(e,"transform")&&e.adj?l():m=g(e,"animation"),k});